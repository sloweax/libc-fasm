macro syscall64 callnum*, [args] {
  common
    local reg
    irps tmp, r9 r8 r10 rdx rsi rdi \{ define reg tmp \}
  forward
  if ~(args eq)
  if ~(args eq reg)
    mov reg, args
    restore reg
  end if
  end if
  common
    irpv _, reg \{ restore reg \}
    if callnum eq 0
      xor rax, rax
    else
      mov rax, callnum
    end if
    syscall
}

define sys64_read 0
define sys64_write 1
define sys64_open 2
define sys64_close 3
define sys64_stat 4
define sys64_fstat 5
define sys64_lstat 6
define sys64_poll 7
define sys64_lseek 8
define sys64_mmap 9
define sys64_mprotect 10
define sys64_munmap 11
define sys64_brk 12
define sys64_rt_sigaction 13
define sys64_rt_sigprocmask 14
define sys64_rt_sigreturn 15
define sys64_ioctl 16
define sys64_pread64 17
define sys64_pwrite64 18
define sys64_readv 19
define sys64_writev 20
define sys64_access 21
define sys64_pipe 22
define sys64_select 23
define sys64_sched_yield 24
define sys64_mremap 25
define sys64_msync 26
define sys64_mincore 27
define sys64_madvise 28
define sys64_shmget 29
define sys64_shmat 30
define sys64_shmctl 31
define sys64_dup 32
define sys64_dup2 33
define sys64_pause 34
define sys64_nanosleep 35
define sys64_getitimer 36
define sys64_alarm 37
define sys64_setitimer 38
define sys64_getpid 39
define sys64_sendfile 40
define sys64_socket 41
define sys64_connect 42
define sys64_accept 43
define sys64_sendto 44
define sys64_recvfrom 45
define sys64_sendmsg 46
define sys64_recvmsg 47
define sys64_shutdown 48
define sys64_bind 49
define sys64_listen 50
define sys64_getsockname 51
define sys64_getpeername 52
define sys64_socketpair 53
define sys64_setsockopt 54
define sys64_getsockopt 55
define sys64_clone 56
define sys64_fork 57
define sys64_vfork 58
define sys64_execve 59
define sys64_exit 60
define sys64_wait4 61
define sys64_kill 62
define sys64_uname 63
define sys64_semget 64
define sys64_semop 65
define sys64_semctl 66
define sys64_shmdt 67
define sys64_msgget 68
define sys64_msgsnd 69
define sys64_msgrcv 70
define sys64_msgctl 71
define sys64_fcntl 72
define sys64_flock 73
define sys64_fsync 74
define sys64_fdatasync 75
define sys64_truncate 76
define sys64_ftruncate 77
define sys64_getdents 78
define sys64_getcwd 79
define sys64_chdir 80
define sys64_fchdir 81
define sys64_rename 82
define sys64_mkdir 83
define sys64_rmdir 84
define sys64_creat 85
define sys64_link 86
define sys64_unlink 87
define sys64_symlink 88
define sys64_readlink 89
define sys64_chmod 90
define sys64_fchmod 91
define sys64_chown 92
define sys64_fchown 93
define sys64_lchown 94
define sys64_umask 95
define sys64_gettimeofday 96
define sys64_getrlimit 97
define sys64_getrusage 98
define sys64_sysinfo 99
define sys64_times 100
define sys64_ptrace 101
define sys64_getuid 102
define sys64_syslog 103
define sys64_getgid 104
define sys64_setuid 105
define sys64_setgid 106
define sys64_geteuid 107
define sys64_getegid 108
define sys64_setpgid 109
define sys64_getppid 110
define sys64_getpgrp 111
define sys64_setsid 112
define sys64_setreuid 113
define sys64_setregid 114
define sys64_getgroups 115
define sys64_setgroups 116
define sys64_setresuid 117
define sys64_getresuid 118
define sys64_setresgid 119
define sys64_getresgid 120
define sys64_getpgid 121
define sys64_setfsuid 122
define sys64_setfsgid 123
define sys64_getsid 124
define sys64_capget 125
define sys64_capset 126
define sys64_rt_sigpending 127
define sys64_rt_sigtimedwait 128
define sys64_rt_sigqueueinfo 129
define sys64_rt_sigsuspend 130
define sys64_sigaltstack 131
define sys64_utime 132
define sys64_mknod 133
define sys64_uselib 134
define sys64_personality 135
define sys64_ustat 136
define sys64_statfs 137
define sys64_fstatfs 138
define sys64_sysfs 139
define sys64_getpriority 140
define sys64_setpriority 141
define sys64_sched_setparam 142
define sys64_sched_getparam 143
define sys64_sched_setscheduler 144
define sys64_sched_getscheduler 145
define sys64_sched_get_priority_max 146
define sys64_sched_get_priority_min 147
define sys64_sched_rr_get_interval 148
define sys64_mlock 149
define sys64_munlock 150
define sys64_mlockall 151
define sys64_munlockall 152
define sys64_vhangup 153
define sys64_modify_ldt 154
define sys64_pivot_root 155
define sys64__sysctl 156
define sys64_prctl 157
define sys64_arch_prctl 158
define sys64_adjtimex 159
define sys64_setrlimit 160
define sys64_chroot 161
define sys64_sync 162
define sys64_acct 163
define sys64_settimeofday 164
define sys64_mount 165
define sys64_umount2 166
define sys64_swapon 167
define sys64_swapoff 168
define sys64_reboot 169
define sys64_sethostname 170
define sys64_setdomainname 171
define sys64_iopl 172
define sys64_ioperm 173
define sys64_create_module 174
define sys64_init_module 175
define sys64_delete_module 176
define sys64_get_kernel_syms 177
define sys64_query_module 178
define sys64_quotactl 179
define sys64_nfsservctl 180
define sys64_getpmsg 181
define sys64_putpmsg 182
define sys64_afs_syscall 183
define sys64_tuxcall 184
define sys64_security 185
define sys64_gettid 186
define sys64_readahead 187
define sys64_setxattr 188
define sys64_lsetxattr 189
define sys64_fsetxattr 190
define sys64_getxattr 191
define sys64_lgetxattr 192
define sys64_fgetxattr 193
define sys64_listxattr 194
define sys64_llistxattr 195
define sys64_flistxattr 196
define sys64_removexattr 197
define sys64_lremovexattr 198
define sys64_fremovexattr 199
define sys64_tkill 200
define sys64_time 201
define sys64_futex 202
define sys64_sched_setaffinity 203
define sys64_sched_getaffinity 204
define sys64_set_thread_area 205
define sys64_io_setup 206
define sys64_io_destroy 207
define sys64_io_getevents 208
define sys64_io_submit 209
define sys64_io_cancel 210
define sys64_get_thread_area 211
define sys64_lookup_dcookie 212
define sys64_epoll_create 213
define sys64_epoll_ctl_old 214
define sys64_epoll_wait_old 215
define sys64_remap_file_pages 216
define sys64_getdents64 217
define sys64_set_tid_address 218
define sys64_restart_syscall 219
define sys64_semtimedop 220
define sys64_fadvise64 221
define sys64_timer_create 222
define sys64_timer_settime 223
define sys64_timer_gettime 224
define sys64_timer_getoverrun 225
define sys64_timer_delete 226
define sys64_clock_settime 227
define sys64_clock_gettime 228
define sys64_clock_getres 229
define sys64_clock_nanosleep 230
define sys64_exit_group 231
define sys64_epoll_wait 232
define sys64_epoll_ctl 233
define sys64_tgkill 234
define sys64_utimes 235
define sys64_vserver 236
define sys64_mbind 237
define sys64_set_mempolicy 238
define sys64_get_mempolicy 239
define sys64_mq_open 240
define sys64_mq_unlink 241
define sys64_mq_timedsend 242
define sys64_mq_timedreceive 243
define sys64_mq_notify 244
define sys64_mq_getsetattr 245
define sys64_kexec_load 246
define sys64_waitid 247
define sys64_add_key 248
define sys64_request_key 249
define sys64_keyctl 250
define sys64_ioprio_set 251
define sys64_ioprio_get 252
define sys64_inotify_init 253
define sys64_inotify_add_watch 254
define sys64_inotify_rm_watch 255
define sys64_migrate_pages 256
define sys64_openat 257
define sys64_mkdirat 258
define sys64_mknodat 259
define sys64_fchownat 260
define sys64_futimesat 261
define sys64_newfstatat 262
define sys64_unlinkat 263
define sys64_renameat 264
define sys64_linkat 265
define sys64_symlinkat 266
define sys64_readlinkat 267
define sys64_fchmodat 268
define sys64_faccessat 269
define sys64_pselect6 270
define sys64_ppoll 271
define sys64_unshare 272
define sys64_set_robust_list 273
define sys64_get_robust_list 274
define sys64_splice 275
define sys64_tee 276
define sys64_sync_file_range 277
define sys64_vmsplice 278
define sys64_move_pages 279
define sys64_utimensat 280
define sys64_epoll_pwait 281
define sys64_signalfd 282
define sys64_timerfd_create 283
define sys64_eventfd 284
define sys64_fallocate 285
define sys64_timerfd_settime 286
define sys64_timerfd_gettime 287
define sys64_accept4 288
define sys64_signalfd4 289
define sys64_eventfd2 290
define sys64_epoll_create1 291
define sys64_dup3 292
define sys64_pipe2 293
define sys64_inotify_init1 294
define sys64_preadv 295
define sys64_pwritev 296
define sys64_rt_tgsigqueueinfo 297
define sys64_perf_event_open 298
define sys64_recvmmsg 299
define sys64_fanotify_init 300
define sys64_fanotify_mark 301
define sys64_prlimit64 302
define sys64_name_to_handle_at 303
define sys64_open_by_handle_at 304
define sys64_clock_adjtime 305
define sys64_syncfs 306
define sys64_sendmmsg 307
define sys64_setns 308
define sys64_getcpu 309
define sys64_process_vm_readv 310
define sys64_process_vm_writev 311
define sys64_kcmp 312
define sys64_finit_module 313
define sys64_sched_setattr 314
define sys64_sched_getattr 315
define sys64_renameat2 316
define sys64_seccomp 317
define sys64_getrandom 318
define sys64_memfd_create 319
define sys64_kexec_file_load 320
define sys64_bpf 321
define sys64_execveat 322
define sys64_userfaultfd 323
define sys64_membarrier 324
define sys64_mlock2 325
define sys64_copy_file_range 326
define sys64_preadv2 327
define sys64_pwritev2 328
define sys64_pkey_mprotect 329
define sys64_pkey_alloc 330
define sys64_pkey_free 331
define sys64_statx 332
define sys64_io_pgetevents 333
define sys64_rseq 334
define sys64_pidfd_send_signal 424
define sys64_io_uring_setup 425
define sys64_io_uring_enter 426
define sys64_io_uring_register 427
define sys64_open_tree 428
define sys64_move_mount 429
define sys64_fsopen 430
define sys64_fsconfig 431
define sys64_fsmount 432
define sys64_fspick 433
define sys64_pidfd_open 434
define sys64_clone3 435
define sys64_close_range 436
define sys64_openat2 437
define sys64_pidfd_getfd 438
define sys64_faccessat2 439
define sys64_process_madvise 440
define sys64_epoll_pwait2 441
define sys64_mount_setattr 442
define sys64_quotactl_fd 443
define sys64_landlock_create_ruleset 444
define sys64_landlock_add_rule 445
define sys64_landlock_restrict_self 446
define sys64_memfd_secret 447
define sys64_process_mrelease 448
